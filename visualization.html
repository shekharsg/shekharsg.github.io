
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Data Visualization | Shekhar Sharan Goyal</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <header>
    <h1>Interactive Visualizations</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="projects.html">Projects</a>
      <a href="publications.html">Publications</a>
      <a href="contact.html">Contact</a>
      <a href="visualization.html">Visualization</a>
    </nav>
  </header>
 <main>
  <h2>Select District to Explore Nitrogen Budget</h2>
  <select id="districtSelect"></select>
  <div id="plot" style="width:100%;height:600px;"></div>

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <script>
    // Load CSV from GitHub or locally
    fetch('nutrient_budjet_uncertainity_12_values_nca.csv')
      .then(response => response.text())
      .then(csvText => {
        const parsed = Papa.parse(csvText, { header: true, skipEmptyLines: true });
        const data = parsed.data;

        // Extract unique districts
        const districts = [...new Set(data.map(d => d["Dist Name"]))].sort();
        const select = document.getElementById("districtSelect");
        districts.forEach(d => {
          const option = document.createElement("option");
          option.value = d;
          option.textContent = d;
          select.appendChild(option);
        });

        select.addEventListener("change", () => renderPlot(select.value, data));
        renderPlot(districts[0], data); // Initial render

        function renderPlot(district, data) {
          const filtered = data.filter(d => d["Dist Name"] === district && d["Year"] && d["mean_N_budjet_kg_ha"]);
          const years = filtered.map(d => +d["Year"]);
          const mean = filtered.map(d => +d["mean_N_budjet_kg_ha"]);
          const p5 = filtered.map(d => +d["percentile_5_N_budjet_kg_ha"]);
          const p95 = filtered.map(d => +d["percentile_95_N_budjet_kg_ha"]);

          const traceMean = {
            x: years,
            y: mean,
            mode: 'lines+markers',
            name: 'Mean N Surplus (kg/ha)',
            line: { color: '#0077aa' }
          };

          const traceBand = {
            x: [...years, ...years.slice().reverse()],
            y: [...p95, ...p5.slice().reverse()],
            fill: 'toself',
            fillcolor: 'rgba(0, 119, 170, 0.2)',
            line: { color: 'transparent' },
            name: 'Uncertainty Range (5â€“95%)',
            type: 'scatter'
          };

          const layout = {
            title: `Nutrient Surplus for ${district}`,
            xaxis: { title: "Year" },
            yaxis: { title: "Nitrogen Budget (kg/ha)" },
            showlegend: true
          };

          Plotly.newPlot("plot", [traceBand, traceMean], layout);
        }
      });
  </script>
</main>

  <footer><p>&copy; 2025 Shekhar Sharan Goyal</p></footer>
</body>
</html>
